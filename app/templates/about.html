{% extends "base.html" %}
{% block content %}
    <h2>About Me</h2>

    <p><strong>Name:</strong> {{ about_me.name }}</p>
    <p><strong>Hometown:</strong> {{ about_me.hometown }}</p>

    <!-- 教育经历展示 -->
    <h3>Education Experience</h3>
    {% for edu in education_experiences %}
        <p><strong>School:</strong> {{ edu.school_name }}</p>
        <p>{{ edu.start_date }} - {{ edu.end_date }}</p>
        <p>{{ edu.learn_details }}</p>
        {% if current_user.is_admin %}
            <!-- 删除按钮 -->
            <form method="POST" action="{{ url_for('main.delete_record', model_name='education', item_id=edu.id) }}">
                <button type="submit" onclick="return confirm('确认删除该教育经历？')" class="btn btn-danger">Delete</button>
            </form>
        {% endif %}
    {% endfor %}

    <!-- 工作经历展示 -->
    <h3>Work Experience</h3>
    {% for work in work_experiences %}
        <p><strong>Company:</strong> {{ work.company_name }}</p>
        <p>{{ work.start_date }} - {{ work.end_date }}</p>
        {% if current_user.is_admin %}
            <!-- 删除按钮 -->
            <form method="POST" action="{{ url_for('main.delete_record', model_name='work', item_id=work.id) }}">
                {{ work_experience_form.hidden_tag() }}
                <button type="submit" onclick="return confirm('确认删除该工作经历？')" class="btn btn-danger">Delete</button>
            </form>
        {% endif %}
    {% endfor %}


    <!-- 评论展示 -->
    <h3>User Comments</h3>
    {% for comment in comments %}
        <div class="comment-box">
            <p><strong>Comment:</strong> {{ comment.content }}</p>
            <p>User: {{ comment.user.username }} | Time: {{ comment.date_posted.strftime('%Y-%m-%d %H:%M') }}</p>

            <!-- ✅ 管理员或评论本人显示删除按钮 -->
            {% if current_user.is_admin or comment.user_id == current_user.id %}
                <form method="POST" action="{{ url_for('main.delete_comment', comment_id=comment.id) }}">
                    {{ comment_form.hidden_tag() }}
                    <button type="submit" onclick="return confirm('Are you sure you want to delete this comment?');" class="btn btn-danger">
                        Delete Comment
                    </button>
                </form>
            {% endif %}
        </div>
    {% endfor %}

    <!-- 分页 -->
    <div class="pagination">
        <div class="page-links">
            {{ pagination.links }}
            {{ pagination.info }}
        </div>
    </div>
    <!-- 评论表单 -->
    <h3>Your Comment</h3>
    <form method="POST">
        {{ comment_form.hidden_tag() }}
        <p>{{ comment_form.content.label }} {{ comment_form.content() }}</p>
        <p><button type="submit">Submit Comment</button></p>
    </form>
{% endblock %}


